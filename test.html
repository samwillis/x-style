<html>
  <head>
    <style>
      :root {
        --s: 1rem;
      }

      .a-test-style {
        color: red;
      }
    </style>
    <script src="x-style.js"></script>
    <script src="x-style-envvar.js"></script>
    <script src="x-style-apply.js"></script>
    <script src="x-style-unnest.js"></script>
    <script>
      xstyle("x-style");
      xstyle.env = {
        '--env-var-red': 'red',
        '--env-var-blue': 'blue',
      };
    </script>

    <script>
      function test2() {
        const el = document.getElementById("test2");
        el.setAttribute(
          "x-style",
          `
            color: blue;
            & span {
              color: red;
            }
          `
        );
      }

      function test4() {
        const el = document.createElement("p");
        el.setAttribute(
          "x-style",
          `
            color: yellow;
            & span {
              color: green;
            }
          `
        );
        el.innerHTML = "Test 4 <span>123</span>";
        document.getElementById("test4").appendChild(el);
      }

      function test5() {
        const innerEl = document.createElement("p");
        innerEl.setAttribute(
          "x-style",
          `
            color: pink;
            & span {
              color: orange;
            }
          `
        );
        innerEl.innerHTML = "Test 5 <span>123</span>";
        const el = document.createElement("div");
        el.appendChild(innerEl);
        document.getElementById("test5").appendChild(el);
      }
    </script>
  </head>
  <body class="css-preload">
    <div x-style="
      color: red;
      font-size: 30px;
      &:hover {
        background-color: yellow;
      }
      & > span {
        color: green;
      }
    ">
      Hello <span>World</span>
    </div>

    <p
      x-style="
        color: red;
        & span {
          color: blue;
        }
      "
    >
      Test 1 <span>something</span>
    </p>

    <p
      id="test2"
      x-style="
        color: red;
        & span {
          color: blue;
        }
      "
    >
      <button onclick="test2()">2: Change CSS</button><br />
      Test 2 <span>something again</span>
    </p>

    <button onclick="test4()">4: Add Element</button>
    <div id="test4"></div>

    <button onclick="test5()">5: Add Nested Element</button>
    <div id="test5"></div>
    <p
      x-style="
        & span:hover {
          color: blue;
        }
      "
    >
      Test 5 <span>something (hover me)</span>
    </p>
    <p x-style="&:hover { color: red }">Test Hover (should be red)</p>
    <p x-style="&:hover { color: red }">Test Hover (should be red)</p>
    <p x-style="
      & span {
        color: env(--env-var-red);
        color: env(--env-var-green, env(--env-var-blue));
      }
    ">Test <span>(should be blue)</span></p>
    <p x-style="
      span {
        @apply .a-test-style;
      }
    ">Test <span>(should be red)</span></p>
  </body>
</html>
